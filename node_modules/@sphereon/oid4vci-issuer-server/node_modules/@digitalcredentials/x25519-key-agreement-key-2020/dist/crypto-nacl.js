'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var nacl = require('tweetnacl');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var nacl__default = /*#__PURE__*/_interopDefaultLegacy(nacl);

/*!
 * Copyright (c) 2021 Digital Bazaar, Inc. All rights reserved.
 */

/**
 * Note: The following two functions are async to match the signature of
 * their native Node.js counterparts (see './crypto.js').
 */

async function deriveSecret({privateKey, remotePublicKey}) {
  return nacl__default['default'].scalarMult(privateKey, remotePublicKey);
}

async function generateKeyPair() {
  // Each is a Uint8Array with 32-byte key
  const {publicKey, secretKey: privateKey} = nacl__default['default'].box.keyPair();
  return {publicKey, privateKey};
}

exports.deriveSecret = deriveSecret;
exports.generateKeyPair = generateKeyPair;
